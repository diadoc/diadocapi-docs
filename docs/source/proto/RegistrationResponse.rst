RegistrationResponse
====================

.. code-block:: protobuf

    message RegistrationResponse {
        required RegistrationStatus RegistrationStatus = 1;
        optional string BoxId = 2;
        optional bytes DataToSign = 3;
    }

    enum RegistrationStatus {
        Unknown = 0;
        AccessIsDenied = 1;
        AccessRequestIsRejected = 2;
        CertificateOwnershipProofIsRequired = 3;
        CertificateIsNotQualified = 4;
        RegistrationIsCompleted = 5;
        RegistrationIsInProgress = 6;
        RegistrationInBranchIsForbidden = 7;
        AccessRequestIsPending = 8;
        OrganizationNotFound = 9;
    }

Содержит запрос на регистрацию в организации по сертификату. Возвращается методом :doc:`../http/Register`.

 - :ref:`RegistrationStatus <registration-statuses>` — статус регистрации
 - *BoxId* — идентификатор ящика найденной или созданной организации
 - *DataToSign* — контент, который необходимо подписать, чтобы подтвердить владение закрытым ключом сертификата. Контент представляет собой строку в кодировке UTF‑8, содержащую идентификаторы пользователя и ящика, отпечаток сертификата и метку времени
 
.. _registration-statuses:

Статусы регистрации
-------------------

Unknown — Неизвестен
^^^^^^^^^^^^^^^^^^^^

**Причины:** Клиент использует устаревшую версию SDK и не может интерпретировать переданный сервером статус

**Действия:** Обновить SDK до последней версии

AccessIsDenied — Доступ запрещен
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Причины:** Переданный сертификат не привязан к текущему пользователю или пользователь был ранее удален из этой организации

**Действия:** Обратиться в техподдержку или отправить запрос на доступ в организацию через веб-интерфейс

CertificateOwnershipProofIsRequired — Требуется подтвердить владение закрытым ключом
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Причины:** Сертификат привязан к пользователю, но нет доказательств владения пользователем закрытым ключом этого сертификата

**Действия:** Подписать контент, содержащийся в свойстве *DataToSign*, передать подпись в метод :doc:`../http/RegisterConfirm`, после этого заново вызвать метод :doc:`../http/Register`. Или авторизоваться в API по сертификату, по которому происходит регистрация

CertificateIsNotQualified — Сертификат не является квалифицированным 
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Причины:** Переданный сертификат не является действующим сертифкатом квалифицированной электронной подписи

**Действия:** Убедиться, что в метод передается действующий неотозванный сертифкат КЭП

AccessRequestIsPending — Отправлен запрос на доступ
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Причины:** Запрос на доступ в организацию отправлен администраторам организации

**Действия:** Дождаться обработки запроса администратором или связаться с ним самостоятельно

AccessRequestIsRejected — Запрос на доступ отклонен
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Причины:** Администратор организации отклонил запрос на доступ

**Действия:** Связаться с администратором организации

RegistrationIsCompleted — Регистрация завершена
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Причины:** Регистрация завершилась созданием сотрудника с правами администратора

**Действия:** Текущий пользователь может совершать действия в ящике с идентификатором, содержащимся в свойстве *BoxId*

RegistrationIsInProgress — Регистрация в процессе
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Причины:** Запущена асинхронная проверка наличия в ящике действующих администраторов

**Действия:** Повторить запрос через несколько секунд

RegistrationInBranchIsForbidden — Регистрация в филиал невозможна
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Причины:** Организация является частью филиальной сети. Самостоятельная регистрация в такие организации невозможна

**Действия:** Связаться с администратором организации

OrganizationNotFound — Организация не найдена
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

**Причины:** Не удалось найти организацию с ИНН переданного сертификата

**Действия:** Обратиться в техподдержку
