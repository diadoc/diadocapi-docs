GenerateTorg12XmlForBuyer
=========================

Имя ресурса: **/GenerateTorg12XmlForBuyer**

HTTP метод: **POST**

Параметры строки запроса:

-  *boxId* - идентификатор ящика;

-  *sellerTitleMessageId* - идентификатор сообщения, содержащего соответствующий титул продавца;

-  *sellerTitleAttachmentId* - идентификатор сущности, представляющей титул продавца, для которого требуется изготовить титул покупателя;

-  *documentVersion* - версия документа;

В запросе должен присутствовать HTTP-заголовок ``Authorization`` с необходимыми данными для :doc:`авторизации <../Authorization>`.

Работа метода зависит от параметра *documentVersion*. Если при вызове метода данный параметр не заполнен или указано значение ``torg12_05_01_02``, то тогда:

- в теле запроса должны содержаться данные для изготовления титула покупателя для товарной накладной в XML-формате, в виде сериализованной структуры :doc:`Torg12BuyerTitleInfo <../proto/Torg12Info>`;

- в теле ответа содержится XML-файл титула покупателя для товарной накладной, построенный на основании данных из запроса. Файл изготавливается в соответствии с :download:`XML-схемой <../xsd/DP_PTORG12_1_989_00_05_01_02.xsd>`, которая описывает рекомендованный ФНС формат для электронных товарных накладных. Имя файла титула покупателя для товарной накладной возвращается в стандартном HTTP-заголовке Content-Disposition;

Если при вызове метода *documentVersion* равен ``tovtorg_05_01_02``, то тогда:

- в теле запроса должны содержаться данные для изготовления титула покупателя для товарной накладной в XML-формате, в виде сериализованной структуры :doc:`TovTorgBuyerTitleInfo <../proto/TovTorgInfo>`;

- в теле ответа содержится XML-файл титула покупателя для товарной накладной, построенный на основании данных из запроса. Файл изготавливается в соответствии с :download:`XML-схемой <../xsd/DP_TOVTORGPOK_1_992_02_05_01_02.xsd>`, которая описывает рекомендованный ФНС формат для электронных товарных накладных. Имя файла титула покупателя для товарной накладной возвращается в стандартном HTTP-заголовке Content-Disposition;

Для вызова этого метода текущий пользователь должен иметь доступ к документу титула продавца, в противном случае возвращается код ошибки 403 (Forbidden).

Возможные HTTP-коды возврата:

-  200 (OK) - операция успешно завершена;

-  400 (Bad Request) - данные в запросе имеют неверный формат или отсутствуют обязательные параметры;

-  401 (Unauthorized) - в запросе отсутствует HTTP-заголовок ``Authorization``, или в этом заголовке содержатся некорректные авторизационные данные;

-  403 (Forbidden) - доступ к ящику с предоставленным авторизационным токеном запрещен;

-  404 (Not Found) - в указанном ящике нет сообщения с идентификатором sellerTitleMessageId, либо в указанном сообщении нет сущности с идентификатором sellerTitleAttachmentId;

-  405 (Method not allowed) - используется неподходящий HTTP-метод;

-  409 (Conflict) - не удалось разобрать соответствующий титул продавца.

-  500 (Internal server error) - при обработке запроса возникла непредвиденная ошибка;