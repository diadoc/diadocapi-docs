GenerateInvoiceXml
==================

.. warning:: Этот метод — устаревший. С 1 октября 2021 года он перестанет работать. Для генерации документов следует использовать метод :doc:`../http/GenerateTitleXml`.

Имя ресурса: **/GenerateInvoiceXml**

HTTP метод: **POST**

Параметры строки запроса:

-  *invoiceType* - тип изготавливаемого документа; принимает одно из значений ``Invoice``, ``InvoiceRevision``, ``InvoiceCorrection`` или ``InvoiceCorrectionRevision``; параметр может отсутствовать; значение по умолчанию - "Invoice".

-  *disableValidation* - отключение валидации полученного Xml документа по формату ФНС; параметр может отсутствовать;

В запросе должен присутствовать HTTP-заголовок ``Authorization`` с необходимыми данными для :doc:`авторизации <../Authorization>`.

В теле запроса должны содержаться данные для изготовления СФ/ИСФ/КСФ/ИКСФ, в виде сериализованной структуры :doc:`../proto/InvoiceInfo` для типов документов Invoice или InvoiceRevision и в виде сериализованной структуры :doc:`../proto/InvoiceCorrectionInfo` для типов документов InvoiceCorrection или InvoiceCorrectionRevision.

В теле ответа содержится XML-файл СФ/ИСФ/КСФ/ИКСФ, построенный на основании данных из запроса. Файл СФ/ИСФ изготавливается в соответствии с :download:`XML-схемой <../xsd/ON_SFAKT_1_897_01_05_02_02.xsd>`, которой должны удовлетворять XML-счета-фактуры, согласно приказа ФНС.

Файл КСФ/ИКСФ изготавливается в соответствии с другой утвержденной ФНС :download:`XML-схемой <../xsd/ON_KORSFAKT_1_911_01_05_02_02.xsd>`. Имя файла СФ/ИСФ/КСФ/ИКСФ (формат которого также определяет приказ ФНС) возвращается в стандартном HTTP-заголовке Content-Disposition.

Возможные HTTP-коды возврата:

-  200 (OK) - операция успешно завершена;

-  400 (Bad Request) - данные в запросе имеют неверный формат или отсутствуют обязательные параметры;

-  401 (Unauthorized) - в запросе отсутствует HTTP-заголовок ``Authorization``, или в этом заголовке содержатся некорректные авторизационные данные;

-  404 (Not Found) - при заполненном поле DiadocOrganizationInfo.BoxId в справочнике Диадока отсутствует организация, которой принадлежит указанный ящик;

-  405 (Method not allowed) - используется неподходящий HTTP-метод;

-  500 (Internal server error) - при обработке запроса возникла непредвиденная ошибка.
