GetCounteragentEvents
=====================

Метод ``GetCounteragentEvents`` возвращает список событий по изменению отношений с :doc:`контрагентами <../entities/counteragent>` у указанного ящика :doc:`ящике <../entities/box>`.

.. http:get:: /V1/GetCounteragentEvents

	:queryparam boxId: идентификатор :doc:`ящика <../../entities/box>` организации.
	:queryparam afterIndexKey: уникальный ключ, позволяющий итерироваться по списку событий. Необязательный параметр.
	:queryparam timestampFromTicks: метка времени, задающая начальную точку периода. Задается целое число тиков, прошедших с момента времени 00:00:00 01.01.0001. Необязательный параметр.
	:queryparam timestampToTicks: метка времени, задающая конечную точку периода. Задается целое число тиков, прошедших с момента времени 00:00:00 01.01.0001. Необязательный параметр.
	:queryparam limit: максимальное количество событий в ответе. Может принимать значение от 1 до 100. Необязательный параметр. По умолчанию имеет значение 100.

	:requestheader Authorization: данные, необходимые для :doc:`авторизации <../Authorization>`.

	:statuscode 200: операция успешно завершена.
	:statuscode 400: данные в запросе имеют неверный формат или отсутствуют обязательные параметры.
	:statuscode 401: в запросе отсутствует HTTP-заголовок ``Authorization`` или в этом заголовке содержатся некорректные авторизационные данные.
	:statuscode 402: у организации с указанным идентификатором ``boxId`` отсутствует или закончилась подписка на API.
	:statuscode 403: доступ к ящику с предоставленным авторизационным токеном запрещен.
	:statuscode 405: используется неподходящий HTTP-метод.
	:statuscode 500: при обработке запроса возникла непредвиденная ошибка.

	:response Body: Тело ответа содержит список событий, представленный структурой :doc:`../proto/BoxCounteragentEventList`.

.. include:: ../include/accessMethod_required_manageCounteragents.txt

Список событий в ответе может содержать не больше 100 элементов. Если событий больше, их можно получить постранично. Для этого при вызове метода передайте параметр ``afterIndexKey``. Если в запросе указан параметр ``afterIndexKey``, метод вернет список событий, следующих за событием с параметром ``afterIndexKey``.

Метод может вернуть один и тот же статус контрагента несколько раз подряд. Это означает, что произошло событие, не влияющее на изменение статуса: например, у контрагента изменилась группа. Мы рекомендуем сохранять последний статус отношений с контрагентом и сравнивать его с новыми событиями.


Примеры использования
---------------------

**Пример HTTP-запроса:**

.. literalinclude:: ../include/getCounteragentEvents_query.txt

**Пример тела ответа:**

.. literalinclude:: ../include/getCounteragentEvents_resp.txt
	:language: json


----

.. rubric:: См. также

*Определение:*
	- :doc:`../entities/counteragent`

*Инструкции:*
	- :doc:`../instructions/counteragentevents`