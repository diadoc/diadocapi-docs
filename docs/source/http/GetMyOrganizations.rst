GetMyOrganizations
==================

Метод ``GetMyOrganizations`` возвращает список ящиков, к которым пользователь имеет доступ.

.. http:get:: /GetMyOrganizations

	:queryparam autoRegister: флаг, указывающий, нужно ли регистрировать пользователя в организацию из сертификата. Пользователь будет зарегистрирован, если в ящике нет действующего администратора и активных пользователей. По умолчанию имеет значение ``true``.

	:requestheader Authorization: данные, необходимые для :doc:`авторизации <../Authorization>`.

	:statuscode 200: операция успешно завершена.
	:statuscode 401: в запросе отсутствует HTTP-заголовок ``Authorization`` или в этом заголовке содержатся некорректные авторизационные данные.
	:statuscode 405: используется неподходящий HTTP-метод.
	:statuscode 409: превышено количество запросов в день.
	:statuscode 500: при обработке запроса возникла непредвиденная ошибка.

	:response Body: Тело ответа содержит список всех ящиков, к которым пользователь имеет доступ, представленный структурой :doc:`OrganizationList <../proto/Organization>`.

Если организации нет в Диадоке и пользователь авторизовался с помощью сертификата КЭП, то метод зарегистрирует новую организацию на основе информации из сертификата и ЕГРЮЛ/ЕГРИП. Информация об организации вернется в ответе вместе со списком ящиков, к которым у пользователя уже есть доступ.

Если в организации нет действующего администратора и активных пользователей, то метод по умолчанию зарегистрирует пользователя в организации и назначит ему права администратора. Регистрация произойдет только в том случае, если выполняются :ref:`условия авторегистрации <autoregistration>`. Чтобы пользователь не был зарегистрирован, укажите флаг ``autoRegister = false`` — этом случае будет зарегистрирована только организация.

Обратите внимание, что каждый пользователь может сделать не более 3 запросов на регистрацию в ящик в день. При выполнении очередной попытки регистрации сверх этого количества метод вернет ошибку ``409 (Conflict)``.

Если организация уже есть в Диадоке, метод с флагом ``autoRegister = false`` вернет информацию об организации из сертификата без повторной регистрации.

Если у пользователя нет сертификата, метод вернет в теле ответа только список организаций, к которым у пользователя есть доступ.