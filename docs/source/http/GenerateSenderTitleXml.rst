GenerateSenderTitleXml
======================

.. warning:: Этод метод — устаревший. Для генерации документов следует использовать метод :doc:`../http/GenerateTitleXml`.

.. http:post:: /GenerateSenderTitleXml

    :query boxId: идентификатор ящика
    :query documentTypeNamedId: уникальный строковый идентификатор типа документа
    :query documentFunction:  строковый идентификатор функции, уникальный в рамках типа документа
    :query documentVersion: строковый идентификатор версии, уникальный в рамках функции типа документа
    :query disableValidation:  отключение валидации полученного Xml документа по XSD-схеме данного типа документа; параметр может отсутствовать
    :query editingSettingId: идентификатор настройки редактирования содержимого документа; параметр может отсутствовать

    :reqheader Authorization: данные, необходимые для :doc:`авторизации <../Authorization>`

    :statuscode 200: операция успешно завершена
    :statuscode 400: данные в запросе имеют неверный формат или отсутствуют обязательные параметры
    :statuscode 401: в запросе отсутствует HTTP-заголовок ``Authorization``, или в этом заголовке содержатся некорректные авторизационные данные
    :statuscode 402: закончилась подписка на API
    :statuscode 403: у пользователя нет права для работы с указанным типом документа
    :statuscode 405: используется неподходящий HTTP-метод
    :statuscode 500: при обработке запроса возникла непредвиденная ошибка

    В теле запроса должен содержаться заполненный XML-файл, соответствующий XSD-схеме контракта для генерации титула отправителя данного типа документа.
    XSD-схема контракта, необходимого для генерации титула, может быть получена с помощью ссылки, доступной в поле *UserDataXsdUrl* контракта :doc:`DocumentTitle <../proto/DocumentTypeDescription>`, который можно получить с помощью метода :doc:`GetDocumentTypes`.

    В теле ответа содержится сгенерированный XML-файл титула отправителя, построенный на основании данных из запроса. Файл изготавливается в соответствии с XSD-схемой соответствующего типа документа.

    Имя файла сгенерированного титула возвращается в стандартном HTTP-заголовке Content-Disposition.

    В случае, если указан параметр *editingSettingId*, то валидация сгенерированного файла будет выполняться по XSD-схеме, соответствующей данной настройке редактирования. Например, это означает, что если настройка редактирования позволяет не указывать какой-либо атрибут, то с помощью данного метода возможно сгенерировать xml-файл, в котором будет отсутствовать данный атрибут. При этом валидация будет осуществлятся так, как если бы данный атрибут был опциональным по XSD-схеме.

**Пример запроса**:

    .. sourcecode:: http

        POST /GenerateSenderTitleXml?boxId=a96be310-0982-461a-8b2a-91d198b7861c&documentTypeNamedId=UniversalTransferDocument&documentFunction=ДОП&documentVersion=utd_05_01_04 HTTP/1.1
        Host: diadoc-api.kontur.ru
        Authorization: DiadocAuth ddauth_api_client_id=key, ddauth_token=token
        Content-Type: application/xml; charset=utf-8

        <?xml version="1.0" encoding="utf-8"?>
        <UniversalTransferDocument Function="ДОП" DocumentDate="20.08.2018" DocumentNumber="QJ4U" Currency="643" DocumentCreator="str1234">
            <Seller>
                <OrganizationReference OrgType="1" BoxId="cf46add1-2975-47de-8506-bdcd1e38dcc0"/>
            </Seller>
            <Buyer>
                <OrganizationReference OrgType="1" BoxId="4d8e6947-1891-4b10-9bfb-a753c44f2e45"/>
            </Buyer>
            <Shipper SameAsSeller="true" />
            <Consignee>
                <OrganizationReference OrgType="3" BoxId="4d8e6947-1891-4b10-9bfb-a753c44f2e45"/>
            </Consignee>
            <Signers>
                <SignerReference BoxId="cf46add1-2975-47de-8506-bdcd1e38dcc0" CertificateThumbprint="DA3EC1B5045FE646A06C84B8D6A0E654FCB32A46"/>
            </Signers>
            <Table TotalWithVatExcluded="123.45" Vat="123.45" Total="123.45" TotalNet="123.45">
                <Item Product="Товарная позиция" TaxRate="18%" Subtotal="123.45"/>
            </Table>
            <TransferInfo OperationInfo="Информация об операции"/>
        </UniversalTransferDocument>

**Пример ответа**:

::

    HTTP/1.1 200 OK

    <?xml version="1.0" encoding="windows-1251"?>
    <Файл ИдФайл="ON_SCHFDOPPR_2BM-7213148974-3118082810454029703720000000000_2BM-6543287956-3568052808304878702630000000004_20180821_7dc509d6-f11c-4b73-a7dd-db2e489d8303" ВерсФорм="5.01" ВерсПрог="Diadoc 1.0">
        <СвУчДокОбор ИдОтпр="2BM-6543287956-3568052808304878702630000000004" ИдПол="2BM-7213148974-3118082810454029703720000000000">
            <СвОЭДОтпр ИННЮЛ="6663003127" ИдЭДО="2BM" НаимОрг="АО &quot;ПФ &quot;СКБ Контур&quot;" />
        </СвУчДокОбор>
        <Документ КНД="1115125" ВремИнфПр="17.03.49" ДатаИнфПр="21.08.2018" НаимЭконСубСост="str1234" Функция="ДОП" ПоФактХЖ="Документ об отгрузке товаров (выполнении работ), передаче имущественных прав (документ об оказании услуг)" НаимДокОпр="Документ об отгрузке товаров (выполнении работ), передаче имущественных прав (Документ об оказании услуг)">
            <СвСчФакт НомерСчФ="QJ4U" ДатаСчФ="20.08.2018" КодОКВ="643">
                <СвПрод>
                    <ИдСв>
                        <СвЮЛУч НаимОрг="ООО Какие люди" ИННЮЛ="4566670058" КПП="224801370" />
                    </ИдСв>
                    <Адрес>
                        <АдрРФ КодРегион="66" Индекс="620028" Район="Верхнеуслонский" Город="Небольшой" НаселПункт="Арамашево" Улица="Юрия Гагарина" Дом="1" Корпус="2" Кварт="3" />
                    </Адрес>
                </СвПрод>
                <ГрузОт>
                    <ОнЖе>он же
                    </ОнЖе>
                </ГрузОт>
                <ГрузПолуч>
                    <ИдСв>
                        <СвЮлНеУч НаимОрг="ООО Здравый смысл" />
                    </ИдСв>
                    <Адрес>
                        <АдрРФ КодРегион="77" Город="Москва" Улица="Первомайская" Дом="7" Корпус="2" Кварт="5" />
                    </Адрес>
                </ГрузПолуч>
                <СвПокуп>
                    <ИдСв>
                        <СвЮЛУч НаимОрг="ООО Здравый смысл" ИННЮЛ="7470003549" КПП="143743639" />
                    </ИдСв>
                    <Адрес>
                        <АдрРФ КодРегион="77" Город="Москва" Улица="Первомайская" Дом="7" Корпус="2" Кварт="5" />
                    </Адрес>
                </СвПокуп>
                <ДопСвФХЖ1 НаимОКВ="Российский рубль" />
            </СвСчФакт>
            <ТаблСчФакт>
                <СведТов НомСтр="1" НаимТов="Товарная позиция" СтТовУчНал="123.45" НалСт="18%">
                    <Акциз>
                        <БезАкциз>без акциза
                        </БезАкциз>
                    </Акциз>
                    <СумНал>
                        <БезНДС>без НДС
                        </БезНДС>
                    </СумНал>
                </СведТов>
                <ВсегоОпл СтТовУчНалВсего="123.45" СтТовБезНДСВсего="123.45">
                    <СумНалВсего>
                        <СумНал>123.45
                        </СумНал>
                    </СумНалВсего>
                    <НеттоВс>123.45
                    </НеттоВс>
                </ВсегоОпл>
            </ТаблСчФакт>
            <СвПродПер>
                <СвПер СодОпер="Информация об операции">
                    <ОснПер НаимОсн="Отсутствует" />
                </СвПер>
            </СвПродПер>
            <Подписант ОснПолн="Должностные обязанности" ОблПолн="1" Статус="1">
                <ИП ИННФЛ="317449403299">
                    <ФИО Фамилия="Ионов" Имя="Василий" Отчество="Владиславович" />
                </ИП>
            </Подписант>
        </Документ>
    </Файл>
