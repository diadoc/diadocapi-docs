Authenticate
============

Имя ресурса: **/Authenticate**

HTTP метод: **POST**

Параметры строки запроса:

-  *login*: имя учетной записи пользователя при авторизации по логину/паролю (может отсутствовать);

-  *password*: пароль учетной записи пользователя при авторизации по логину/паролю (обязателен при наличии параметра login);

В запросе должен присутствовать HTTP-заголовок ``Authorization`` с параметром *ddauth_api_client_id* (см. раздел :doc:`Авторизация <../Authorization>`).

В случае, если авторизация производится по сертификату, в теле запроса должен содержаться :rfc:`X.509 <5280>` сертификат пользователя, сериализованный в `DER <http://www.itu.int/ITU-T/studygroups/com17/languages/X.690-0207.pdf>`__. В противном случае тело запроса должно быть пустым.

Для аутентификации по ключу, полученному доверенным сервисом, нужно передать этот ключ в параметре *key*.

В случае успешного выполнения запроса, в теле ответа содержится авторизационный токен. Если авторизация производится по логину/паролю, тело ответа следует интерпретировать как строку в кодировке UTF-8.

Если же авторизация производится по сертификату, то выдаваемый токен будет зашифрован в адрес пользовательского сертификата. В этом случае тело ответа следует интерпретировать как структуру :rfc:`CMS EnvelopedData <5652#section-6>` в DER-кодировке.

Возможные HTTP-коды возврата:

-  200 (OK) - операция успешно завершена;

-  400 (Bad Request) - данные в запросе имеют неверный формат или отсутствуют обязательные параметры;

-  401 (Unauthorized) - в запросе отсутствует HTTP-заголовок ``Authorization``, или в этом заголовке отсутствует параметр *ddauth_api_client_id*, или переданный в нем ключ разработчика не зарегистрирован в Диадоке;

-  405 (Method not allowed) - используется неподходящий HTTP-метод;

-  500 (Internal server error) - при обработке запроса возникла непредвиденная ошибка.
