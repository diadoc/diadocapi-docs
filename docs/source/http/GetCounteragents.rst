GetCounteragents
================

Метод ``GetCounteragents`` осуществляет поиск контрагентов по указанным параметрам.

Версии метода:
	- :ref:`GetCounteragents_v2` — не возвращает для контрагента список его подразделений.
	- :ref:`GetCounteragents_v1` — возвращает для контрагента список его подразделений.

.. _GetCounteragents_v2:

v2
--

.. http:get:: /V2/GetCounteragents

	:queryparam myOrgId: идентификатор организации, для которой осуществляется поиск контрагентов.
	:queryparam counteragentStatus: статус контрагента. Необязательный параметр, используется для фильтрации результатов поиска.
	:queryparam afterIndexKey: уникальный ключ, позволяющий итерироваться по всему списку контрагентов, удовлетворяющих фильтру. Необязательный параметр.

	:requestheader Authorization: данные, необходимые для :doc:`авторизации <../Authorization>`.
	
	:statuscode 200: операция успешно завершена.
	:statuscode 400: данные в запросе имеют неверный формат или отсутствуют обязательные параметры.
	:statuscode 401: в запросе отсутствует HTTP-заголовок ``Authorization`` или в этом заголовке содержатся некорректные авторизационные данные.
	:statuscode 402: у организации с указанным идентификатором ``myOrgId`` закончилась подписка на API.
	:statuscode 403: доступ к списку контрагентов организации ``myOrgId`` с предоставленным авторизационным токеном запрещен.
	:statuscode 405: используется неподходящий HTTP-метод.
	:statuscode 500: при обработке запроса возникла непредвиденная ошибка.

	:response Body: Тело ответа содержит список контрагентов организации ``myOrgId``, находящихся в статусе ``counteragentStatus``, представленный структурой :doc:`CounteragentList <../proto/Counteragent>`. В поле ``CounteragentList.TotalCount`` указано количество всех контрагентов, удовлетворяющих запросу.

Пользователь имеет право запрашивать и производить действия со списком контрагентов организации ``myOrgId``, если у него есть доступ к ящику этой организации.

Список ``CounteragentList.Counteragents`` может содержать не более 100 элементов. Чтобы получить остальные элементы,  вызовите метод ``GetCounteragents`` с теми же параметрами и с указанием ``afterIndexKey``. В зависимости от значения параметра ``afterIndexKey`` метод работает следующим образом:

- Если в запросе отсутствует параметр ``afterIndexKey``, то метод вернет начало списка контрагентов, удовлетворяющих фильтру.
- Если в запросе указан параметр ``afterIndexKey``, то возвращенный список начнется с контрагента, следующего за контрагентом с ключом ``afterIndexKey``; контрагент с ключом ``afterIndexKey`` в этот список не попадает. Ключ контрагента указан в поле ``IndexKey`` структуры :doc:`../proto/Counteragent`.

Параметр ``counteragentStatus`` предназначен для фильтрации результатов поиска. Если параметр ``counteragentStatus`` не задан, метод вернет весь список контрагентов. Значения статусов контрагента описаны в перечислении :doc:`CounteragentStatus <../proto/Counteragent>`. В качестве параметра ``counteragentStatus`` можно передавать следующие значения:

	- ``IsMyCounteragent``,
	- ``InvitesMe``,
	- ``IsInvitedByMe``,
	- ``Rejected``.

Во вложенной структуре :doc:`Counteragent.Organization <../proto/Organization>` поле ``Departments`` будет пустым.

.. _GetCounteragents_v1:

v1
--

.. http:get:: /GetCounteragents

	:queryparam myOrgId: идентификатор организации, для которой осуществляется поиск контрагентов.
	:queryparam counteragentStatus: статус контрагента. Необязательный параметр, используется для фильтрации результатов поиска.
	:queryparam afterIndexKey: уникальный ключ, позволяющий итерироваться по всему списку контрагентов, удовлетворяющих фильтру. Необязательный параметр.

	:requestheader Authorization: данные, необходимые для :doc:`авторизации <../Authorization>`.
	
	:statuscode 200: операция успешно завершена.
	:statuscode 400: данные в запросе имеют неверный формат или отсутствуют обязательные параметры.
	:statuscode 401: в запросе отсутствует HTTP-заголовок ``Authorization`` или в этом заголовке содержатся некорректные авторизационные данные.
	:statuscode 402: у организации с указанным идентификатором ``myOrgId`` закончилась подписка на API.
	:statuscode 403: доступ к списку контрагентов организации ``myOrgId`` с предоставленным авторизационным токеном запрещен.
	:statuscode 405: используется неподходящий HTTP-метод.
	:statuscode 500: при обработке запроса возникла непредвиденная ошибка.

	:response Body: Тело ответа содержит список контрагентов организации ``myOrgId``, находящихся в статусе ``counteragentStatus``, представленный структурой :doc:`CounteragentList <../proto/Counteragent>`. В поле ``CounteragentList.TotalCount`` указано количество всех контрагентов, удовлетворяющих запросу.

Пользователь имеет право запрашивать и производить действия со списком контрагентов организации ``myOrgId``, если у него есть доступ к ящику этой организации.

Список ``CounteragentList.Counteragents`` может содержать не более 100 элементов. Чтобы получить остальные элементы, вызовите метод ``GetCounteragents`` с теми же параметрами и с указанием ``afterIndexKey``. В зависимости от значения параметра ``afterIndexKey`` метод работает следующим образом:

- Если в запросе отсутствует параметр ``afterIndexKey``, то метод вернет начало списка контрагентов, удовлетворяющих фильтру.
- Если в запросе указан параметр ``afterIndexKey``, то возвращенный список начнется с контрагента, следующего за контрагентом с ключом ``afterIndexKey``; контрагент с ключом ``afterIndexKey`` в этот список не попадает. Ключ контрагента указан в поле ``IndexKey`` структуры :doc:`../proto/Counteragent`.

Параметр ``counteragentStatus`` предназначен для фильтрации результатов поиска. Если параметр ``counteragentStatus`` не задан, метод вернет весь список контрагентов. Значения статусов контрагента описаны в перечислении :doc:`CounteragentStatus <../proto/Counteragent>`. В качестве параметра ``counteragentStatus`` можно передавать следующие значения:

	- ``IsMyCounteragent``,
	- ``InvitesMe``,
	- ``IsInvitedByMe``,
	- ``Rejected``.