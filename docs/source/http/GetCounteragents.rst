GetCounteragents
================

Имя ресурса: **/GetCounteragents**

HTTP-метод: **GET**

Параметры строки запроса:

-  *myOrgId*: идентификатор организации, для которой осуществляется поиск контрагентов;

-  *counteragentStatus*: статус, по которому требуется отфильтровать список контрагентов (может отсутствовать);

-  *afterIndexKey*: уникальный ключ, позволяющий итерироваться по всему списку контрагентов, удовлетворяющих фильтру (может отсутствовать).

В запросе должен присутствовать HTTP-заголовок ``Authorization`` с необходимыми данными для :doc:`авторизации <../Authorization>`. Пользователь имеет право производить манипуляции со списком контрагентов организации myOrgId или запрашивать его, если у него есть доступ хотя бы в один из ящиков этой организации.

Метод возвращает список контрагентов организации myOrgId, находящихся в статусе counteragentStatus. Возможные значения параметра counteragentStatus:

-  IsMyCounteragent (отношение партнерства установлено и действует);
-  InvitesMe (контрагент прислал запрос на установление отношения партнерства);
-  IsInvitedByMe (в адрес контрагента был отправлен запрос на установление отношения партнерства);
-  Rejected (отношение партнерства было разоварвано с той или иной стороны, либо запрос на установление отношения партнерства был отклонен той или иной стороной).

Если параметр counteragentStatus не задан, выдается весь список контрагентов.

Список выдается в виде сериализованной структуры данных :doc:`CounteragentList <../proto/Counteragent>`. В поле CounteragentList.TotalCount указывается общее количество контрагентов, удовлетворяющих запросу. В массиве CounteragentList.Counteragents содержится не более 100 элементов; для получения остальных документов нужно вызывать метод GetCounteragents с теми же параметрами, но с указанием значения параметра afterIndexKey.

Необязательный параметр afterIndexKey позволяет итерироваться по списку контрагентов, удовлетворяющих фильтру. Если в запросе присутствует параметр afterIndexKey, то выдача начинается с контрагента, следующего в возвращаемом списке за контрагентом, имеющим ключ afterIndexKey (сам контрагент с ключом afterIndexKey в выдачу не попадает). Ключ контрагента можно получить из поля IndexKey структуры :doc:`Counteragent <../proto/Counteragent>`. Если параметр afterIndexKey в запросе отсутствует, то выдается начало списка контрагентов, удовлетворяющих фильтру.

Возможные HTTP-коды возврата:

-  200 (OK) - операция успешно завершена;

-  400 (Bad Request) - данные в запросе имеют неверный формат или отсутствуют обязательные параметры;

-  401 (Unauthorized) - в запросе отсутствует HTTP-заголовок ``Authorization``, или в этом заголовке содержатся некорректные авторизационные данные;

-  403 (Forbidden) - доступ к списку контрагентов организации myOrgId с предоставленным авторизационным токеном запрещен;

-  405 (Method not allowed) - используется неподходящий HTTP-метод;

-  500 (Internal server error) - при обработке запроса возникла непредвиденная ошибка.